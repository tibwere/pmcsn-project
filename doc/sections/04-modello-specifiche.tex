\section{Modello Delle Specifiche}\label{sec:modello-specfiche}
Le seguenti variabili, definite per ogni istante di tempo $t$, forniscono una base per il modello delle specifiche del sistema in questione:
\begin{itemize}
\item Il numero di clienti presenti all'interno del sistema è dato da:
\begin{equation}
Customers(t) \in \mathbb{N}
\end{equation}
\item Il numero di clienti in servizio allo sportello $i$-esimo (con $i \in \lbrace 1, 2, \cdots, M \rbrace$) è dato da:
\begin{equation}
Server_i(t) = 
\begin{cases}
0 & \text{se il server è idle} \\
1 & \text{se il server è busy}
\end{cases}
\end{equation}
\item Per ciascuna coda $(h, j)$ con:
\begin{itemize}
\item $h \in \lbrace \mathtt{BANCO\_POSTA},\ \mathtt{STANDARD}\rbrace$
\item $j \in \lbrace \mathtt{UNICA\_OP},\ \mathtt{PAGAM\_PREL},\ \mathtt{SPED\_RIT} \rbrace$
\end{itemize}
il numero di clienti in essa presenti è dato da:
\begin{equation}
Queue_{h,j}(t) \in \mathbb{N}
\end{equation}
\end{itemize}

La relazione matematica che lega le variabili appena descritte è la seguente:
\begin{equation}
Customers(t) = \sum_{(h,j) \in R}
 Queue_{h,j}(t) + \sum_{i=1}^{M} Server_i(t)
\end{equation}
dove $R = \lbrace \mathtt{BANCO\_POSTA},\ \mathtt{STANDARD}\rbrace \times \lbrace \mathtt{UNICA\_OP},\mathtt{PAGAM\_PREL},\ \mathtt{SPED\_RIT} \rbrace$.

Di seguito sono riportate alcune assunzioni che saranno alla base di questa e delle successive fasi dello studio:
\begin{itemize}
\item I clienti arrivano all'ufficio postale ad istanti di tempo casuali, il che implica:
\begin{itemize}
\item Distribuzione poissoniana degli arrivi.
\item Distribuzione esponenziale dei tempi di interarrivo.
\end{itemize}
\item La probabilità che un cliente sia titolare di un conto \textsl{BancoPosta} è pari a $p_{BP} = 0.25$.
\item Le probabilità con cui ciascuna tipologia di ticket viene acquisita sono le seguenti:
\begin{equation*}
\begin{array}{l c l}
\uo{} & \rightarrow & p_{UO} = 0.5 \\
\pp{} & \rightarrow & p_{PP} = 0.35 \\
\sr{} & \rightarrow & p_{SR} = 0.15
\end{array}
\end{equation*} 
\item I tempi di servizio sono distribuiti esponenzialmente.
\item I clienti afferenti ad una stessa coda vengono serviti in accordo ad una disciplina FIFO (First-In, First-Out).
\item Il servizio di un cliente non può essere interrotto per favorire l'avanzamento di un altro con priorità superiore.
\end{itemize}

La politica di scheduling del sistema assume caratteristiche tipiche sia dello scheduling size-based che di quello astratto. In particolare:
\begin{itemize}
\item Ha caratteristiche astratte perché la probabilità di ricadere in una delle classi di priorità è funzione della frequenza con cui l'utente prende quella tipologia di ticket e non del tempo necessario all'elaborazione della richiesta da parte del servente. Infatti, il tempo necessario ad elaborare un ticket della classe $i$ non è necessariamente compreso in un intervallo $(x_{i-1}, x_i]$ bensì può assumere valori su tutto il semiasse reale positivo. 
\item Ha caratteristiche size-based perché classi di priorità diverse non condividono lo stesso tempo di servizio medio, ovvero $\exists\ i,j\ t.c.\ E[S_i] \neq E[S_j]$.
\end{itemize}

Al fine di agevolare la comprensione del funzionamento dello scheduler di sistema, di seguito sono riportati gli pseudocodici \ref{alg:modello-specifiche-1} e \ref{alg:modello-specifiche-2} che descrivono, rispettivamente, il comportamento del servente generico e di quello dedicato.

\begin{algorithm}
\scaption{Algoritmo di schedulazione del servente generico}
\label{alg:modello-specifiche-1}
\begin{algorithmic}[1]
\Procedure{GeneralPurposeServer}{}
\While{true}
	\If{customer owns \textsl{BancoPosta}}
		\If{\textsl{UnicaOperazioneBP} queue not empty}
			\State \textit{processes the first ticket of that type}
		\Else
			\If{\textsl{PagamentiPrelieviBP} queue not empty}
				\State \textit{processes the first ticket of that type}
			\EndIf
		\EndIf
	\Else
		\If{\textsl{UnicaOperazione} queue not empty}
			\State \textit{processes the first ticket of that type}
		\Else
			\If{\textsl{PagamentiPrelievi} queue not empty}
				\State \textit{processes the first ticket of that type}
			\EndIf
		\EndIf
	\EndIf
\EndWhile
\EndProcedure
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\scaption{Algoritmo di schedulazione del servente dedicato a ticket \sr{}}
\label{alg:modello-specifiche-2}
\begin{algorithmic}[1]
\Procedure{DedicatedServer}{}
\While{true}
	\If{customer owns \textsl{BancoPosta}}
		\If{\textsl{SpedizioneRitiriBP} queue not empty}
			\State \textit{processes the first ticket of that type}
		\Else
			\If{\textsl{UnicaOperazioneBP} queue not empty}
				\State \textit{processes the first ticket of that type}
			\Else
				\If{\textsl{PagamentiPrelieviBP} queue not empty}
					\State \textit{processes the first ticket of that type}
				\EndIf
			\EndIf
		\EndIf
	\Else
		\If{\textsl{SpedizioneRitiri} queue not empty}
			\State \textit{processes the first ticket of that type}
		\Else
			\If{\textsl{UnicaOperazione} queue not empty}
				\State \textit{processes the first ticket of that type}
			\Else
				\If{\textsl{PagamentiPrelievi} queue not empty}
					\State \textit{processes the first ticket of that type}
				\EndIf
			\EndIf
		\EndIf
	\EndIf
\EndWhile
\EndProcedure
\end{algorithmic}
\end{algorithm}

Assumendo che:
\begin{itemize}
\item Il tempo medio di servizio $E[S]$ sia pari a $10\ min$.
\item Il tempo medio di servizio per una richiesta di tipo \pp{} sia pari ad una volta e mezzo quello di una \uo{}, ovvero $E[S_{PP}] = 1.5 \cdot E[S_{UO}]$.
\item Il tempo medio di servizio per una richiesta di tipo \sr{} sia pari a due volte quello di una \uo{}, ovvero $E[S_{SR}] = 2 \cdot E[S_{UO}]$.
\end{itemize}
è possibile ricavare gli $E[S_i]$, con $i \in \lbrace UO, PP, SR \rbrace$, come segue:
\begin{equation}
\begin{split}
E[S] &= p_{UO}\cdot E[S_{UO}] + p_{PP}\cdot E[S_{PP}] + p_{SR}\cdot E[S_{SR}] \\
&= p_{UO}\cdot E[S_{UO}] + p_{PP}\cdot 1.5\cdot E[S_{UO}] + p_{SR}\cdot 2\cdot E[S_{UO}] \\
&= (p_{UO} + 1.5\cdot p_{PP} + 2\cdot p_{SR}) \cdot E[S_{UO}]
\end{split}
\end{equation}
da cui:
\begin{equation}
\begin{cases}
E[S_{UO}] = \frac{E[S]}{(p_{UO} + 1.5\cdot p_{PP} + 2\cdot p_{SR})} = \frac{400}{53} \simeq 7.5471698\ min \\[1em]
E[S_{PP}] = 1.5\cdot E[S_{UO}] = \frac{600}{53} \simeq 11.3207547\ min \\[1em]
E[S_{SR}] = 2 \cdot E[S_{UO}] = \frac{800}{53} \simeq 15.0943396\ min
\end{cases}
\end{equation}

I risultati ottenuti possono essere verificati con il seguente consistency check:
\begin{equation}
p_{UO}\cdot E[S_{UO}] + p_{PP}\cdot E[S_{PP}] + p_{SR}\cdot E[S_{SR}] = 10\ min = E[S]\qquad \text{\color{forestgreen}\textbf{OK} \checkmark}
\end{equation}

\begin{table}[ht]
\centering
{\tablecolors
\begin{tabular}{| l | r |}
\hline
Grandezza & Valore misurato nel 2019 \\
\hline
N$^o$ di clienti al giorno & 1.4 mln \\
\hline
N$^o$ di uffici postali & 12 809 \\
\hline
\end{tabular}}
\scaption{Estratto dei dati di interesse a partire dalla fonte citata}
\label{table:modello-specifiche-1}
\end{table}

Per ricavare il throughput del sistema $X$ si è fatto uso dei dati dati provenienti da \textsl{"Principali dati economici e finanziari di Poste Italiane"}\footnote{\url{https://www.posteitaliane.it/it/performance-finanziaria.html}} nel modo seguente:
\begin{equation}
X = \frac{\# \lbrace \text{clienti al giorno} \rbrace}{\# \lbrace \text{uffici postali} \rbrace} \cdot \frac{1}{24 \cdot 60} = \frac{8750}{115281} \simeq 0.0759015\ req/min
\end{equation} 

È opportuno osservare che, sotto l'ipotesi di \textsl{job flow balance}, la frequenza d'arrivo media al centro $\lambda$ coincide con il throughput $X$.


















